<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=0.9" />
  <title>Página Inicial</title>
  <link rel="stylesheet" href="../styles/style_logistica.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
  <header class="container_header">
    <div class="header_content">
      <a href="home_logged.html">
        <h1>SYSTECH</h1>
      </a>
    </div>
  </header>

  <main>
    <div class="menu_vertical">
      <button id="toggleMenu"><i class="fa-solid fa-bars fa-2x"></i></button>

      <div class="c_logistica">
        <button class="btn_logistica" id="btn_logistica">
          <div class="text_logistica">LOGÍSTICA <i class="fa-solid fa-boxes-stacked fa-2x"></i></div>
        </button>
      </div>

      <div class="c_orcamento">
        <button class="btn_orcamento" id="btn_orcamento">
          <div class="text_orcamento">ORÇAMENTOS <i class="fa-solid fa-money-check-dollar fa-2x"></i></div>
        </button>
      </div>

      <div class="c_funcionarios">
        <button class="btn_funcionarios" id="btn_funcionarios">
          <div class="text_funcionarios">FUNCIONÁRIOS <i class="fa-solid fa-person fa-2x"></i></div>
        </button>
      </div>

      <div class="c_config">
        <button class="btn_config" id="btn_config">
          <div class="text_config">
            CONFIGURAÇÕES <i class="fa-solid fa-gears fa-lg"></i>
          </div>
        </button>
      </div>
    </div>

    <div class="container_header_conteudo">
      <div class="campo_btns">
        <div>
          <button class="btn_estoque" id="btn_estoque">
            <div>
              <span class="text_main"><i class="fa-solid fa-warehouse" style="color: #ffffff;"></i> Estoque</span>
            </div>
          </button>
        </div>

        <div>
          <button class="btn_cadastro" id="btn_cadastro">
            <div>
              <span class="text_main"><i class="fa-solid fa-clipboard-list fa-lg" style="color: #ffffff;"></i>
                Cadastros</span>
            </div>
          </button>
        </div>

        <div>
          <button class="btn_saida" id="btn_saida">
            <div>
              <span class="text_main"><i class="fa-solid fa-truck-arrow-right" style="color: #ffffff;"></i>
                Saídas</span>
            </div>
          </button>
        </div>

        <div>
          <button class="btn_registro" id="btn_registro">
            <div>
              <span class="text_main"><i class="fa-regular fa-calendar-days" style="color: #ffffff;"></i>
                Registros</span>
            </div>
          </button>
        </div>
      </div>


<!-- ========== INÍCIO DO CAMPO DE PESQUISA ========== -->
<div class="container_pesquisa">
        <div class="container_form_pesquisa">
          <form action="http://localhost:3000/pesquisa-produto" method="GET">
            <div class="input_container">
              <div class="input_pesquisa" id="input_pesquisa">
                <div class="input-field">
                  <label for="" class="form_campo_pesquisa">Pesquisar </label>
                  <input type="text" name="campo_pesquisa" class="form_campo_pesquisa" placeholder=" Digite o nome do produto">
                  <i class="fa-solid fa-magnifying-glass fa-lg" style="color: #000000;"></i>
                </div>
              </div>
            </div>
          </form>
        </div>
</div>
<!-- ========== FIM DO CAMPO DE PESQUISA ========== -->

<!-- ========== INÍCIO DO FORMULÁRIO DE CADASTRO ========== -->
<div class="container_form_cadastro" id="container_form_cadastro">
  <div class="container_form">
    <form action="http://localhost:3000/cadastrar-produto" method="POST">
      <div class="input_container">
        <div class="input_cadastro" id="">

          <div class="input-field">
            <label for="" class="label_campo_cadastro_nome">Nome</label>
            <input type="text" name="nome" id="input_cadastro_nome" class="campo_cadastro_nome">
          </div>

          <div class="input-field">
            <label for="" class="label_campo_cadastro_marca">Marca</label>
            <input type="text" name="marca" id="input_cadastro_marca" class="campo_cadastro_marca">
          </div>

          <div class="input-field">
            <label for="" class="label_campo_cadastro_quantidade">Quantidade</label>
            <input type="text" name="quantidade" id="input_cadastro_qtd" class="campo_cadastro_quantidade">
          </div>

          <div class="input-field">
              <button type="submit" class="salvar_produto" id="salvar_produto">Cadastrar</button>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
<!-- ========== FIM DO FORMULÁRIO DE CADASTRO ========== -->

<!-- ========== INÍCIO DA TABELA DE ESTOQUE ========== -->
      <div class="tabela-container" id="tabela_estoque">
        <div class="tabela_dashboard">
          <table class="tabela_estilizada">
            <thead>
              <tr>
                <th>Nome</th>
                <th>Marca</th>
                <th>Quantidade</th>
                <th>Alerta</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>
      </div>
<!-- ========== FIM DA TABELA DE ESTOQUE ========== -->

<!-- ========== INÍCIO DA TABELA DE CADASTROS ========== -->
      <div class="tabela-container" id="tabela_cadastros">
        <div class="tabela_dashboard">
          <table class="tabela_estilizada">
            <thead>
              <tr>
                <th>Nome</th>
                <th>Marca</th>
                <th>Quantidade</th>
                <th>Cadastrado em</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>
      </div>
<!-- ========== FIM DA TABELA DE CADASTROS ========== -->


<!-- ========== INÍCIO DO FORM DE SAÍDAS ========== -->
<div class="container_form_saida" id="container_form_saida">
  <div class="container_form">
    <form action="http://localhost:3000/saida-produto" method="POST">
      <div class="input_container">
        <div class="input_saida" id="">

          <div class="input-field">
            <label for="" class="label_campo_saida_nome">Nome</label>
            <input type="text" name="campo_saida_nome" id="input_saida_nome" class="campo_saida_nome">
          </div>

          <div class="input-field">
            <label for="" class="label_campo_saida_marca">Marca</label>
            <input type="text" name="campo_saida_marca" id="input_saida_marca" class="campo_saida_marca">
          </div>

          <div class="input-field">
            <label for="" class="label_campo_saida_quantidade">Quantidade</label>
            <input type="text" name="campo_saida_quantidade" id="input_saida_qtd" class="campo_saida_quantidade">
          </div>

          <div class="input-field">
            <label for="" class="label_campo_saida_destino">Destino</label>
            <input type="text" name="campo_saida_destino" id="input_saida_destino" class="campo_saida_destino">
          </div>

          <div class="input-field">
              <button type="submit" class="retirar_produto" id="enviar_produto">Enviar Produto</button>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
<!-- ========== FIM DO FORM DE SAÍDAS ========== -->



<!-- ========== INÍCIO DA TABELA DE SAÍDAS ========== -->
      <div class="tabela-container" id="tabela_saidas">
        <div class="tabela_dashboard">
          <table class="tabela_estilizada">
            <thead>
              <tr>
                <th>Nome</th>
                <th>Marca</th>
                <th>Quantidade</th>
                <th>Saida em</th>
                <th>Destino</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>
      </div>
<!-- ========== FIM DA TABELA DE SAÍDAS ========== -->

<!-- ========== INÍCIO DA TABELA DE REGISTROS ========== -->
      <div class="tabela-container" id="tabela_registros">
        <div class="tabela_dashboard">
          <table class="tabela_estilizada">
            <thead>
              <tr>
                <th>Nome</th>
                <th>Marca</th>
                <th>Quantidade</th>
                <th>Entrada em</th>
                <th>Saída em</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>
      </div>
<!-- ========== FIM DA TABELA DE REGISTROS ========== -->

    </div>
  </main>

  <footer></footer>
  
  <!-- ========== BUSCANDO DADOS DA TABELA DE ESTOQUE ========== -->
  <script>
  fetch('http://localhost:3000/estoque')
    .then(response => response.json())
    .then(produtos => {
      const tbody = document.querySelector('#tabela_estoque tbody');
      tbody.innerHTML = '';

      produtos.forEach(produto => {
        const tr = document.createElement('tr');
        
        // Verifica se a quantidade é 5 ou menos
        const precisaComprar = produto.quantidade <= 5;
        
        // Adiciona a badge "COMPRAR" se necessário
        const alertaHTML = precisaComprar 
          ? '<td><span class="badge alerta">COMPRAR</span></td>' 
          : '<td></td>';

        tr.innerHTML = `
          <td>${produto.nome}</td>
          <td>${produto.marca}</td>
          <td>${produto.quantidade}</td>
          ${alertaHTML}
        `;
        tbody.appendChild(tr);
      });
    })
    .catch(err => {
      console.error('Erro ao buscar estoque:', err);
    });
</script>
  <!-- ========== ENCERRANDO A BUSCA DE DADOS DA TABELA DE ESTOQUE ========== -->


  <script>
  // Quando o botão “cadastro” for clicado, chama a API
  document.getElementById('btn_cadastro')
    .addEventListener('click', () => {

      fetch('http://localhost:3000/cadastros')
        .then(res => res.json())
        .then(cadastros => {
          const tbody = document.querySelector('#tabela_cadastros tbody');
          tbody.innerHTML = '';  // limpa o conteúdo antes

          cadastros.forEach(item => {
            const tr = document.createElement('tr');

            // formata a data/hora de criado_em para o padrão local
            const dataHora = new Date(item.criado_em)
              .toLocaleString('pt-BR', {
                day:   '2-digit',
                month: '2-digit',
                year:  'numeric',
                hour:   '2-digit',
                minute: '2-digit',
                second: '2-digit'
              });

            tr.innerHTML = `
              <td>${item.nome}</td>
              <td>${item.marca}</td>
              <td>${item.quantidade}</td>
              <td>${dataHora}</td>
            `;
            tbody.appendChild(tr);
          });
        })
        .catch(err => {
          console.error('Erro ao buscar cadastros:', err);
        });
    });
</script>


<script>
  document.getElementById('btn_registro')
  .addEventListener('click', () => {
    fetch('http://localhost:3000/registros')
      .then(r => r.json())
      .then(registros => {
        const tbody = document.querySelector('#tabela_registros tbody');
        tbody.innerHTML = '';
        registros.forEach(item => {
          const criado = item.criado_em
            ? new Date(item.criado_em).toLocaleString('pt-BR')
            : '';
          const saida = item.saida_em
            ? new Date(item.saida_em).toLocaleString('pt-BR')
            : '';
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${item.nome}</td>
            <td>${item.marca}</td>
            <td>${item.quantidade}</td>
            <td>${criado}</td>
            <td>${saida}</td>
          `;
          tbody.appendChild(tr);
        });
      })
      .catch(err => console.error('Erro ao buscar registros:', err));
  });

</script>

<script>
  //TABELA DE SAÍDA
  document.getElementById('btn_saida')
    .addEventListener('click', () => {
      fetch('http://localhost:3000/saidas')
        .then(res => res.json())
        .then(saidas => {
          const tbody = document.querySelector('#tabela_saidas tbody');
          tbody.innerHTML = '';  // limpa antes de popular

          saidas.forEach(item => {
            const tr = document.createElement('tr');

            // formata a data/hora de saída
            const dataSaida = new Date(item.saida_em)
              .toLocaleString('pt-BR', {
                day:    '2-digit',
                month:  '2-digit',
                year:   'numeric',
                hour:   '2-digit',
                minute: '2-digit',
                second: '2-digit'
              });

            tr.innerHTML = `
              <td>${item.nome}</td>
              <td>${item.marca}</td>
              <td>${item.quantidade}</td>
              <td>${dataSaida}</td>
              <td>${item.destino}</td>
            `;
            tbody.appendChild(tr);
          });
        })
        .catch(err => console.error('Erro ao buscar saídas:', err));
    });
</script>



  
  <script src="../../../javascript/script.js"></script>


</body>

</html>